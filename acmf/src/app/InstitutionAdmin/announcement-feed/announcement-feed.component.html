<div *ngFor="let announcement of announcements" class="bg-white shadow rounded-2xl p-5">
    <!-- Header -->
    <div class="flex items-center gap-3 mb-3">
      <img
        [src]="announcement.createdBy.profile.profileImage || '/assets/default-avatar.png'"
        class="w-10 h-10 rounded-full object-cover"
      />
      <div>
        <p class="font-semibold">
          {{ announcement.createdBy.profile.name || announcement.createdBy.email }}
        </p>
        <p class="text-xs text-gray-500">
          {{ announcement.institution.name }} â€¢
          {{ announcement.createdAt | date: 'medium' }}
        </p>
      </div>
    </div>
  
    <!-- Content -->
    <ng-container *ngIf="!editing; else editForm">
      <h3 class="font-semibold text-lg mb-2">{{ announcement.title }}</h3>
      <p class="text-gray-700 mb-3">{{ announcement.content }}</p>
  
      <!-- Attachments -->
      <div *ngIf="(announcement.fileUrls?.length ?? 0) > 0" class="grid grid-cols-2 gap-2 mb-3">
        <div *ngFor="let file of announcement.fileUrls ?? []">
          <a [href]="file" target="_blank" class="block border rounded-lg overflow-hidden">
            <img
              *ngIf="file.endsWith('.jpg') || file.endsWith('.png')"
              [src]="file"
              class="w-full h-40 object-cover"
            />
            <div
              *ngIf="!file.endsWith('.jpg') && !file.endsWith('.png')"
              class="p-3 text-sm text-blue-600 underline"
            >
              Download File
            </div>
          </a>
        </div>
      </div>
  
      <!-- Actions -->
      <div class="flex justify-end gap-3 border-t pt-3">
        <button
          class="px-3 py-1 text-sm rounded-md border border-gray-300"
          (click)="deleteAnnouncement(announcement.id)"
        >
          Delete
        </button>
        <button
          class="px-3 py-1 text-sm rounded-md border border-gray-300"
          (click)="toggleEdit()"
        >
          Edit
        </button>
      </div>
    </ng-container>
  
    <!-- Inline edit form -->
    <ng-template #editForm>
      <app-admin-announcement-form
        [institutionId]="institutionId"
        [announcement]="announcement"
        (saved)="onSaved($event)"
      ></app-admin-announcement-form>
      <div class="flex justify-end mt-2">
        <button
          class="px-3 py-1 text-sm rounded-md border border-gray-300"
          (click)="toggleEdit()"
        >
          Cancel
        </button>
      </div>
    </ng-template>
  </div>
  