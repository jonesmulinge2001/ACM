<div class="flex flex-col h-[400px] bg-white rounded-lg border shadow-sm">
  <!-- Header -->
  <div class="flex items-center justify-between px-4 py-2 border-b bg-gray-50">
    <!-- Left: avatar + name -->
    <div class="flex items-center gap-2">
      <img
        [src]="participantImage"
        alt="avatar"
        class="w-8 h-8 rounded-full object-cover border"
      />
      <span class="font-medium text-gray-800 text-sm">
        {{ participantName }}
      </span>
    </div>

    <!-- Right: close button -->
    <button
      (click)="close.emit()"
      class="text-gray-400 hover:text-gray-600 transition"
      aria-label="Close chat"
    >
      âœ•
    </button>
  </div>

  <!-- Meta -->
  <div class="text-xs text-gray-500 px-4 py-1 border-b">
    {{ messages.length }} messages
  </div>
  
  <!-- Messages -->
  <div class="flex-1 overflow-y-auto p-4 space-y-3">
    <div
      *ngFor="let msg of messages"
      [ngClass]="{
        'text-right': msg.senderId.toString() === myId,
        'text-left': msg.senderId.toString() !== myId
      }"
    >
      <div
        class="inline-block px-3 py-2 rounded-2xl text-sm max-w-[70%] break-words shadow-sm"
        [ngClass]="
          msg.senderId.toString() === myId
            ? 'bg-blue-600 text-white'
            : 'bg-gray-100 text-gray-800'
        "
      >
        {{ msg.content }}
      </div>
      <div class="text-xs text-gray-400 mt-1 flex items-center gap-1">
        <img
          *ngIf="msg.sender?.profileImage"
          [src]="msg.sender.profileImage"
          alt="avatar"
          class="w-4 h-4 rounded-full object-cover border"
        />
        {{ msg.sender.name || "Unknown" }}
      </div>
    </div>
  </div>

  <!-- Composer -->
  <div class="p-3 border-t flex items-center gap-2 bg-gray-50">
    <input
      [(ngModel)]="newMessage"
      (keyup.enter)="sendMessage()"
      type="text"
      placeholder="Write a message..."
      class="flex-1 px-3 py-2 border rounded-full text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"
    />
    <button
      (click)="sendMessage()"
      class="px-4 py-2 bg-blue-600 text-white rounded-full hover:bg-blue-700 transition text-sm"
    >
      Send
    </button>
  </div>
</div>
