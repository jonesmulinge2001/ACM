<div class="relative">
    <!-- Bell + badge -->
    <button (click)="togglePanel()" class="relative p-2 rounded-full hover:bg-gray-100">
      <!-- Bell icon -->
      <svg class="w-6 h-6 text-gray-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <path stroke-linecap="round" stroke-linejoin="round"
          d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6 6 0 10-12 0v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
      </svg>
  
      <!-- Red badge -->
      <span *ngIf="unreadCount > 0"
        class="absolute -top-1 -right-1 inline-flex items-center justify-center min-w-[18px] h-[18px] px-1 text-xs font-bold text-white bg-red-600 rounded-full">
        {{ unreadCount }}
      </span>
    </button>
  
    <!-- Panel -->
    <div *ngIf="panelOpen"
      class="origin-top-right absolute right-0 mt-3 w-96 rounded-2xl shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-50">
      <!-- Header -->
      <div class="p-3 border-b flex items-center justify-between">
        <div class="font-semibold">Notifications</div>
        <div class="text-sm text-gray-500 flex items-center gap-3">
          <button (click)="markAllAsRead()" class="text-xs underline hover:text-blue-600">Mark all read</button>
          <a routerLink="/notifications" class="text-xs hover:text-blue-600">View all</a>
        </div>
      </div>
  
      <!-- Notifications list -->
      <div class="max-h-80 overflow-y-auto">
        <div *ngIf="notifications.length === 0" class="p-4 text-center text-sm text-gray-500">
          No notifications
        </div>
  
        <ul>
          <li *ngFor="let n of notifications" class="px-3">
            <button (click)="openNotification(n)"
              class="w-full text-left py-3 flex gap-3 items-start rounded-lg hover:bg-gray-50 transition"
              [ngClass]="{'bg-blue-50': n.status === 'UNREAD'}">
              
              <!-- Icon -->
              <div class="flex-shrink-0">
                <div class="w-9 h-9 flex items-center justify-center rounded-full bg-gray-100">
                  <svg *ngIf="n.type === 'ANNOUNCEMENT'" class="w-5 h-5 text-blue-600" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round"
                      d="M15 10l4.553-2.276a1 1 0 00-.553-1.898L15 6.5" />
                  </svg>
                </div>
              </div>
  
              <!-- Content -->
              <div class="flex-1 min-w-0">
                <div class="flex items-center justify-between">
                  <div class="text-sm font-medium text-gray-900 truncate">{{ n.message }}</div>
                  <div class="text-xs text-gray-400 ml-2 whitespace-nowrap">
                    {{ timeAgo(n.createdAt) }}
                  </div>
                </div>
                <div class="text-xs text-gray-500 mt-1">
                  <span *ngIf="n.type === 'ANNOUNCEMENT'">Tap to view announcement</span>
                </div>
              </div>
            </button>
          </li>
        </ul>
      </div>
    </div>
  </div>
  