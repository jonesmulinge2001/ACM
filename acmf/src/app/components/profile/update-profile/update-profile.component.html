<div
  *ngIf="showProfileModal"
  class="fixed inset-0 z-50 flex items-center justify-center bg-black/40 backdrop-blur-sm"
>
  <!-- Modal Container -->
  <div
    class="bg-white w-full max-w-4xl max-h-[90vh] overflow-y-auto rounded-2xl shadow-2xl relative animate-fade-in"
  >
    <!-- Close Button -->
    <button
      (click)="closeProfileModal()"
      class="absolute top-4 right-4 text-gray-400 hover:text-black transition duration-200 text-2xl font-light"
      aria-label="Close"
    >
      &times;
    </button>

    <!-- Cover Section -->
    <div class="h-48 bg-gray-100 relative rounded-t-2xl overflow-hidden">
      <img
        *ngIf="coverPreview"
        [src]="coverPreview"
        class="absolute inset-0 w-full h-full object-cover"
      />
      <label
        class="absolute top-3 right-3 cursor-pointer bg-white/90 hover:bg-white text-sm text-blue-600 px-3 py-1 rounded-full shadow-sm transition"
      >
        <input
          type="file"
          class="hidden"
          (change)="onCoverPhotoSelected($event)"
        />
        Change Cover
      </label>
    </div>

    <!-- Profile Image -->
    <div class="relative -mt-12 flex justify-center">
      <div class="relative">
        <img
          *ngIf="profilePreview"
          [src]="profilePreview"
          class="w-24 h-24 rounded-full border-4 border-white object-cover shadow-md"
        />
        <div
          *ngIf="!profilePreview"
          class="w-24 h-24 bg-gray-300 rounded-full border-4 border-white shadow-md"
        ></div>
        <label
          class="absolute bottom-0 right-0 bg-blue-600 text-white p-1.5 rounded-full cursor-pointer shadow hover:bg-blue-700 transition"
        >
          <input
            type="file"
            class="hidden"
            (change)="onProfileImageSelected($event)"
          />
          <span class="text-xs font-semibold">Edit</span>
        </label>
      </div>
    </div>

    <!-- Editable Form -->
    <form
      [formGroup]="profileForm"
      (ngSubmit)="onSubmit()"
      class="px-8 pt-6 pb-8 grid gap-6 grid-cols-1 md:grid-cols-2"
    >
      <!-- Input Group -->
      <div class="space-y-1">
        <label class="text-sm font-medium text-gray-600">Full Name</label>
        <input
          formControlName="name"
          type="text"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
        />
      </div>

      <div class="space-y-1">
        <label class="text-sm font-medium text-gray-600">Institution</label>
        <select
          formControlName="institutionId"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
        >
          <option value="" disabled>Select your institution</option>
          <option *ngFor="let inst of institutions" [value]="inst.id">
            {{ inst.name }}
          </option>
        </select>
      </div>
      

      <div class="space-y-1">
        <label class="text-sm font-medium text-gray-600">Academic Level</label>
        <input
          formControlName="academicLevel"
          type="text"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
        />
      </div>

      <div class="space-y-1">
        <label class="text-sm font-medium text-gray-600">Skills (comma separated)</label>
        <input
          formControlName="skills"
          type="text"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition"
        />
      </div>

      <div class="md:col-span-2 space-y-1">
        <label class="text-sm font-medium text-gray-600">Bio</label>
        <textarea
          formControlName="bio"
          rows="4"
          class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition resize-none"
        ></textarea>
      </div>

      <!-- Submit Button -->
      <div class="md:col-span-2 flex justify-end pt-2">
        <button
          type="submit"
          class="bg-blue-600 hover:bg-blue-700 text-white font-medium px-6 py-2 rounded-lg transition disabled:opacity-50 disabled:cursor-not-allowed"
          [disabled]="profileForm.invalid"
        >
          Save Changes
        </button>
      </div>
    </form>
  </div>
</div>
