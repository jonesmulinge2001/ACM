<div
  class=" w-full bg-white border border-gray-200 p-5 rounded-xl transition cursor-pointer hover:shadow-md active:scale-[0.99]"
  (click)="navigateToProfile()"
>
  <div class="flex items-start justify-between gap-4">
    <div class="flex items-center gap-4 flex-1 min-w-0">
      <img
        [src]="profile.profileImage || '/assets/default-avatar.png'"
        class="w-14 h-14 rounded-full object-cover flex-shrink-0 border border-gray-100"
        alt="avatar"
      />
      <div class="flex-1 min-w-0">
        <h3 class="text-sm font-semibold text-gray-900 truncate">{{ profile.name }}</h3>
        <p class="text-xs text-gray-600 truncate">
          {{ profile.academicLevel }} â€¢ {{profile.institution?.name}}
        </p>
      </div>
    </div>

    <div (click)="$event.stopPropagation()" class="flex-shrink-0">
      <button
        *ngIf="!isFollowing"
        (click)="handleFollow()"
        class="bg-gradient-to-r from-blue-500 to-indigo-600 hover:from-blue-600 hover:to-indigo-700 text-white px-4 py-1.5 rounded-full text-sm font-medium shadow-sm transition active:scale-95 flex items-center gap-1"
      >
        <i class="ri-user-add-line text-base"></i>
        Connect
      </button>
      <button
        *ngIf="isFollowing"
        (click)="handleUnfollow()"
        class="bg-gradient-to-r from-gray-200 to-gray-300 hover:from-gray-300 hover:to-gray-400 text-gray-800 px-4 py-1.5 rounded-full text-sm font-medium shadow-sm transition active:scale-95 flex items-center gap-1"
      >
        <i class="ri-user-check-line text-base"></i>
        Connected
      </button>
    </div>
  </div>

  <div class="mt-3 text-sm text-gray-700 leading-relaxed">
    <p>
      {{ getShortBio(profile.bio) }}
      <button
        *ngIf="profile.bio && profile.bio.split(' ').length > 8"
        class="text-blue-600 font-medium text-xs hover:underline"
        (click)="toggleReadMore($event)"
      >
        {{ profile.showFullBio ? "Show less" : "Show more" }}
      </button>
    </p>

    <div class="mt-3 flex flex-wrap gap-2 items-center">
      <ng-container *ngFor="let skill of (showAllSkills ? profile.skills : profile.skills | slice:0:2); let i = index">
        <span
          [ngClass]="[
            'px-3 py-1 rounded-full text-xs font-medium shadow-sm transition transform hover:scale-105 hover:shadow-md cursor-pointer',
            i % 5 === 0 ? 'bg-gradient-to-r from-blue-100 to-blue-200 text-blue-700' :
            i % 5 === 1 ? 'bg-gradient-to-r from-indigo-100 to-indigo-200 text-indigo-700' :
            i % 5 === 2 ? 'bg-gradient-to-r from-emerald-100 to-emerald-200 text-emerald-700' :
            i % 5 === 3 ? 'bg-gradient-to-r from-purple-100 to-purple-200 text-purple-700' :
                          'bg-gradient-to-r from-rose-100 to-rose-200 text-rose-700'
          ]"
        >
          {{ skill }}
        </span>
      </ng-container>

      <button
        *ngIf="profile.skills.length > 3"
        class="text-blue-600 text-xs font-medium hover:underline ml-1"
        (click)="toggleSkills($event)"
      >
        {{ showAllSkills ? "-" : "+" }}
      </button>
    </div>
  </div>

  <div class="mt-5 text-xs text-gray-600 flex justify-between border-t pt-3">
    <div class="flex gap-4">
      <span class="font-medium">{{ profile.followersCount || 0 }} Followers</span>
      <span class="font-medium">{{ profile.followingCount || 0 }} Following</span>
    </div>
    <span class="italic">Joined {{ profile.createdAt | date : "MMM yyyy" }}</span>
  </div>
</div>